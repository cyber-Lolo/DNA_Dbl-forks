#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Fri Dec 23 19:33:05 2022

@author: lopid
"""

import numpy as np
import matplotlib.pyplot as plt
import random
import math

X=np.arange(1,110,5)

Y1=np.array([579.7340000000721,
 356.9760000000144,
 235.26199999999662,
 199.53599999999452,
 157.67999999999554,
 144.29999999999612,
 129.23999999999725,
 121.41199999999736,
 94.99999999999888,
 95.13999999999885,
 86.8719999999993,
 77.45199999999974,
 75.00599999999987,
 66.90800000000016,
 68.17399999999999,
 63.66400000000022,
 60.6920000000003,
 52.320000000000434,
 53.584000000000415,
 50.80600000000036,
 45.300000000000345,
 48.46000000000037])

Y2=np.array([432.9540000000419,
 303.7520000000058,
 199.37799999999697,
 146.59199999999598,
 117.07399999999762,
 101.97199999999847,
 88.12999999999927,
 78.10999999999972,
 69.32800000000009,
 66.57000000000012,
 56.01800000000041,
 53.276000000000394,
 49.71400000000039,
 48.8360000000003,
 44.96200000000035,
 40.966000000000285,
 38.67400000000028,
 36.79800000000026,
 37.16400000000024,
 34.764000000000216,
 33.868000000000194,
 32.9920000000002])

F1=np.array([292.231912432626,
 103.41285715037706,
 66.80463723425652,
 52.58404990108804,
 38.949757380500905,
 38.558526942815654,
 46.448255080248856,
 39.0737182259358,
 20.82556121692645,
 23.877864226097284,
 19.15522946873675,
 18.497807870122546,
 15.309100692071361,
 14.162850560532915,
 19.452740783755225,
 13.6392633232147,
 14.705996600026396,
 8.723393834970471,
 10.578437691833312,
 11.38995013158524,
 9.086803618434889,
 10.276594766750359])

F2=np.array([302.53603369520977,
 115.7940693472895,
 77.47672241390262,
 39.87853477749427,
 29.95190017344306,
 27.88205903443849,
 21.896495153333262,
 18.808458203690343,
 15.17849847646277,
 17.99335710755435,
 10.263541104316682,
 9.761691656675023,
 10.225928026345628,
 13.814800179517473,
 9.487821457004879,
 9.889946612596102,
 7.100107323132618,
 6.8732667633376,
 9.251675740102522,
 7.832158323221112,
 10.532168627590517,
 8.456331119344963])
"""
L1=np.log(Y1)
P1=np.flip(np.polyfit(X, L1, 1))
a1=math.exp(P1[0])
tau1=1/P1[1]
Fit1= a1*np.exp(X/tau1)

L2=np.log(Y2)
P2=np.flip(np.polyfit(X, L2, 1))
a2=math.exp(P2[0])
tau2=1/P2[1]
Fit2= a2*np.exp(X/tau2)
plt.plot(X,Fit1, color='black',label=r'\frac{a_{1}}{\sqrt{t}}+b_{1}')
plt.plot(X,Fit2, color='red',label='Exponential fit (modified speeds)')
"""

Inv=1/np.sqrt(X)
pol1=np.flip(np.polyfit(Inv, Y1, 1))
a_i1=pol1[1]
b_i1=pol1[0]
Inverse1=a_i1*Inv+b_i1


pol2=np.flip(np.polyfit(Inv, Y2, 1))
a_i2=pol2[1]
b_i2=pol2[0]
Inverse2=a_i2*Inv+b_i2

plt.plot(X,Inverse1,'--', color='black',label=r'$t=\frac{a_{1}}{\sqrt{n}}+b_{1}$')
plt.plot(X,Inverse2,'--', color='red',label=r'$t=\frac{a_{2}}{\sqrt{n}}+b_{2}$')

plt.plot(X,Y1,color='blue',label='Unmodified model')
plt.plot(X,Y2,color='orange',label='Modified speeds')

plt.legend(loc="upper right")
plt.xlabel('Number of activated origins at t=0')
plt.ylabel('Time to reach last coalescence')